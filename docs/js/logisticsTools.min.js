(async()=>{if(!(()=>{if("https:"===location.protocol)return!0;confirm('Logistics Tools requires a secure connection in order to run\n\nClick "OK" to reload this page using https, you can then re-run Logistics Tools\n\nClick "Cancel" to abort the loading of Logistics Tools and reload this page')?location.assign(location.href.replace("http:","https:")):location.reload()})())return!1;{const t=await fetch("/user/me").then(t=>t.json()),e=await fetch(`/servicecentres/${t.service_centre}`).then(t=>t.json()),a=await fetch("/client/").then(t=>t.json());t.consignment_printer_name||(t.consignment_printer_name=t.container_printer_name=e.label_printer_name),((t,e,a)=>{let i="https://dvere.github.io/logistics-tools/",l=$("#main-container > div:first-child > div.page-content");$("<link>",{id:"lt_style",rel:"stylesheet",href:`${i}css/logisticsTools.css?v=${$.now()}`}).appendTo($("head")),$("<script>",{id:"lt_func",src:`${i}js/logisticsFunctions.js?v=${$.now()}`}).appendTo($("body"));let n={};n.query={q:"collected:"+e.code,count:5e3,location:e.description};let c={required:"required",pattern:"(CAP)?(TRNK|CSTC|OOC)[0-9]{8}",autocomplete:"off"},s=$("<div>",{id:"lt_menu"}).append($("<button>",{id:"lt_ci",class:"lt-button",text:"Consignments Inspector"})).append($("<button>",{id:"lt_ac",class:"lt-button",text:"Auto Containers"})).append($("<button>",{id:"lt_lp",class:"lt-button",text:"Label Packs"})).append($("<button>",{id:"lt_sc",class:"lt-button",text:"Swap Containers"})).append($("<button>",{id:"lt_gp",class:"lt-button",text:"Print GP Containers"})).append($("<button>",{id:"lt_bp",class:"lt-button",text:"Bulk POD"})),p=$("<div>",{id:"ci_tab",class:"lt-tab"}).append($("<div>",{id:"ci_form"}).append($("<input>",{id:"ci_date",type:"date"})).append($("<select>",{id:"ci_status"})).append($("<select>",{id:"ci_client"})).append($("<button>",{id:"ci_btn",class:"lt-button",text:"Look up collections"})).append($("<label>").css({gridColumn:"1 / 3",marginBottom:"-0.57em"}).html('<input id="ci_ncr" type="checkbox" />&nbsp;Exclude records processed to trunk container'))),d=$("<div>",{id:"ac_tab",class:"lt-tab"}).append($("<div>",{id:"ac_form"}).append($("<input>",{id:"ac_ti"}).attr({autocomplete:"off"})).append($("<textarea>",{id:"ac_data"})).append($("<button>",{id:"ac_btn",class:"lt-button",text:"Process"})).append($("<button>",{id:"ac_clr",class:"lt-button",text:"Clear"}))),o=$("<div>",{id:"lp_tab",class:"lt-tab"}).append($("<div>",{id:"lp_form"}).append($("<input>",{id:"lp_ti"}).attr({autocomplete:"off"})).append($("<textarea>",{id:"lp_data"})).append($("<button>",{id:"lp_btn",class:"lt-button",text:"Process"})).append($("<button>",{id:"lp_clr",class:"lt-button",text:"Clear"}))),r=$("<div>",{id:"sc_tab",class:"lt-tab"}).append($("<div>",{id:"sc_form"}).append($("<input>",{id:"sc_old",class:"lt-input"}).attr(c)).append($("<input>",{id:"sc_new",class:"lt-input"}).attr(c)).append($("<button>",{id:"sc_btn",class:"lt-button"}).text("Move Records"))),_=$("<div>",{id:"gp_tab",class:"lt-tab"}),u=$("<div>",{id:"bp_tab",class:"lt-tab"}).append($("<div>",{id:"bp_form"}).append($("<input>",{id:"bp_name",class:"lt-input"})).append($("<input>",{id:"bp_courier",class:"lt-input"})).append($("<input>",{id:"bp_time",type:"time"})).append($("<input>",{id:"bp_date",type:"date"})).append($("<textarea>",{id:"bp_data"})).append($("<button>",{id:"bp_btn",class:"lt-button",text:"Process"})).append($("<button>",{id:"bp_clr",class:"lt-button",text:"Clear"}))),b=$("<span>",{id:"lt_close",title:"Close Logistics Tools"}).html("&#10006;").click(()=>location.reload()),h=$("<div>",{id:"lt_container"}).append(s).append($("<div>",{id:"lt_insert"}).append(p).append(d).append(o).append(r).append(_).append(u)).append($("<div>",{id:"lt_results"})).append(b);l.prepend(h),$.each(["RECEIVED","COLLECTED","ROUTED","RECONCILED"],(t,e)=>$("<option>",{value:e,text:e}).appendTo($("#ci_status"))),$.each(a,(t,e)=>{let a=$("<option>",{value:e.id,text:e.name});11270==e.id&&(a=$("<option>",{value:e.id,text:e.name,selected:"selected"})),a.appendTo($("#ci_client"))}),$("#ci_btn").click(()=>{n.query.received_at=$("#ci_date").val(),n.query.status=$("#ci_status").val(),n.query.client_id=$("#ci_client").val(),n.ncr=$("#ci_ncr").is(":checked")?1:0,ciMain(n)}),$("#ac_ti").keypress(t=>{if(13==t.which){return new Audio("/audio/success").play(),$("#ac_data").val((t,e)=>`${e+$("#ac_ti").val()}\n`),$("#ac_data").scrollTop($("#ac_data")[0].scrollHeight),$("#ac_ti").select(),!1}}),$("#lp_ti").keypress(t=>{if(13==t.which){return new Audio("/audio/success").play(),$("#lp_data").val((t,e)=>`${e+$("#lp_ti").val()}\n`),$("#lp_data").scrollTop($("#lp_data")[0].scrollHeight),$("#lp_ti").select(),!1}}),$("#ac_btn").click(()=>{let t=$("#ac_data").val().toUpperCase().trim().split("\n");if(!validateBarcodes(t,/^PCS[0-9]{9}|(CAP)?(TRNK|CSLC|CSTC|OOC)[0-9]{8}$/))return alert("Invalid Data, please check input and try again"),!1;$("#ac_ti").focus(),acMain(t)}),$("#ac_clr").click(()=>{$("#ac_data").val(""),$("#lt_results").empty(),$("#ac_ti").focus()}),$("#lp_btn").click(()=>{let t=$("#lp_data").val().toUpperCase().trim().split("\n");if(!validateBarcodes(t,/^PCS[0-9]{9}$/))return alert("Invalid Data, please check input and try again"),!1;$("#lp_ti").focus(),lpMain(t)}),$("#lp_clr").click(()=>{$("#lp_data").val(""),$("#lt_results").empty(),$("#lp_ti").focus()}),$("#sc_btn").click(()=>{let t=$("#sc_old").val().trim(),e=$("#sc_new").val().trim();scMain(t,e)}),$("#lt_ci").click(()=>{$(".lt-tab").hide(),$("#lt_results").empty(),$("#ci_tab").show()}),$("#lt_ac").click(()=>{$(".lt-tab").hide(),$("#lt_results").empty(),$("#ac_tab").show(),$("#ac_ti").focus()}),$("#lt_lp").click(()=>{$(".lt-tab").hide(),$("#lt_results").empty(),$("#lp_tab").show(),$("#lp_ti").focus()}),$("#lt_sc").click(()=>{$(".lt-tab").hide(),$("#lt_results").empty(),$("#sc_tab").show(),$("#sc_old").focus()}),$("#lt_gp").click(()=>{$(".lt-tab").hide(),$("#lt_results").empty(),$("#gp_select").html(populateGPs(t)),$("#gp_tab").show()}),$("#lt_bp").click(()=>{$(".lt-tab").hide(),$("#lt_results").empty(),$("#bp_tab").show(),$("#bp_name").focus()})})(t,e,a)}})();